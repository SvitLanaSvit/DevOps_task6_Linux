# üîπ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ —ñ—Å–Ω—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á john
id -u john

# üîπ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ john —ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è
sudo adduser john
sudo passwd john

# üîπ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è OpenSSH-—Å–µ—Ä–≤–µ—Ä—É
sudo apt update
sudo apt install openssh-server -y

# üîπ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Å–ª—É–∂–±–∏ SSH
sudo systemctl status ssh

# üîπ –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É SSH
sudo nano /etc/ssh/sshd_config

# üîπ –í–Ω–µ—Å–µ–Ω–Ω—è –∞–±–æ –∑–º—ñ–Ω–∞ —Ç–∞–∫—ñ—Ö —Ä—è–¥–∫–∏ —É —Ñ–∞–π–ª—ñ:
# --- –æ–±–∏—Ä–∞—î–º–æ –ø–æ—Ä—Ç, –∑–∞–±–æ—Ä–æ–Ω—è—î–º–æ root, –∑–∞–±–æ—Ä–æ–Ω—è—î–º–æ –ø–∞—Ä–æ–ª—ñ, –¥–æ–∑–≤–æ–ª—è—î–º–æ —Ç—ñ–ª—å–∫–∏ john ---
Port 2222
PermitRootLogin no
PasswordAuthentication no
AllowUsers john (sudo nano /etc/ssh/sshd_config.d/10_allowUser.conf)

# üîπ –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ socket-based –∑–∞–ø—É—Å–∫ —ñ –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –Ω–∞ systemd
sudo systemctl disable ssh.socket
sudo systemctl stop ssh.socket

# üîπ –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —ñ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±–∏ sshd
sudo systemctl enable ssh
sudo systemctl restart ssh

# üîπ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ—Ä—Ç
sudo netstat -tulnp

# üîπ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è SSH-–∫–ª—é—á–∞ (–≤—ñ–¥ —ñ–º–µ–Ω—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ svitlana)
ssh-keygen -t rsa -b 4096 -f ~/john_id_rsa

# üîπ –î–æ–¥–∞—î–º–æ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ john
sudo mkdir -p /home/john/.ssh
sudo cp ~/john_id_rsa.pub /home/john/.ssh/authorized_keys
sudo chown -R john:john /home/john/.ssh
sudo chmod 700 /home/john/.ssh
sudo chmod 600 /home/john/.ssh/authorized_keys

# üîπ –¢–µ—Å—Ç SSH-–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø–æ –∫–ª—é—á—É –¥–æ john (—É—Å–ø—ñ—à–Ω–µ)
ssh -i ~/john_id_rsa -p 2222 john@localhost

# üîπ –¢–µ—Å—Ç –±–µ–∑ –∫–ª—é—á–∞ (–º–∞—î –±—É—Ç–∏ –≤—ñ–¥–º–æ–≤–∞, —è–∫—â–æ PasswordAuthentication no)
ssh -p 2222 john@localhost

# üîπ –¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ svitlana (–º–∞—î –±—É—Ç–∏ –≤—ñ–¥–º–æ–≤–∞, —è–∫—â–æ –Ω–µ –≤ AllowUsers)
ssh -p 2222 svitlana@localhost

# üîπ –Ø–∫—â–æ —Ö–æ—á–µ–º–æ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤—Ö—ñ–¥ —ñ –¥–ª—è svitlana –ø–æ –∫–ª—é—á—É:
# 1. –î–æ–¥–∞—î–º–æ –¥–æ AllowUsers: AllowUsers john svitlana
# 2. –ó–≥–µ–Ω–µ—Ä—É—î–º–æ –∫–ª—é—á –¥–ª—è svitlana
ssh-keygen -t rsa -b 4096 -f ~/.ssh/svitlana_id_rsa

# 3. –î–æ–¥–∞—î–º–æ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –¥–æ ~/.ssh/authorized_keys
cat ~/.ssh/svitlana_id_rsa.pub >> ~/.ssh/authorized_keys
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys

# üîπ –¢–µ—Å—Ç –≤—Ö–æ–¥—É –¥–æ svitlana –∑ –∫–ª—é—á–µ–º (—É—Å–ø—ñ—à–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è)
ssh -i ~/.ssh/svitlana_id_rsa -p 2222 svitlana@localhost

# üîπ –Ø–∫—â–æ –Ω–µ –¥–æ–¥–∞–Ω–æ –¥–æ AllowUsers ‚Äî –±—É–¥–µ –ø–æ–º–∏–ª–∫–∞:
# User svitlana from 127.0.0.1 not allowed because not listed in AllowUsers

# üîπ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ª–æ–≥—ñ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó:
sudo tail -n 50 /var/log/auth.log
